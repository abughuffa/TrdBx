@page "/pages/TrdBx/SimCards/{id:int}/view"


@using CleanArchitecture.Blazor.Application.Features.SimCards.DTOs
@using CleanArchitecture.Blazor.Application.Features.SimCards.Queries.GetById


@inherits MudComponentBase
@inject IStringLocalizer<SimCards> L
@inject NavigationManager Navigation
@attribute [Authorize(Policy = Infrastructure.PermissionSet.Permissions.SimCards.View)]

<PageTitle>@Title</PageTitle>

<MudContainer Class="mt-3" MaxWidth="MaxWidth.Medium">
    @if (model != null)
    {
        <MudCard Class="pa-2">
            <MudCardHeader>
                <CardHeaderContent>
                    <MudText Typo="Typo.h6">@Title</MudText>
                </CardHeaderContent>
            </MudCardHeader>
            <MudCardContent>
                <MudGrid Spacing="3" Class="readonly-grid">
                    <MudItem md="6">
                        <ReadOnlyFieldX6 Label="@L[model.GetMemberDescription(x=>x.SimCardNo)]" Value="model.SimCardNo"></ReadOnlyFieldX6>
                    </MudItem>
                    <MudItem md="6">
                        <ReadOnlyFieldX6 Label="@L[model.GetMemberDescription(x=>x.ICCID)]" Value="model.ICCID"></ReadOnlyFieldX6>
                    </MudItem>

                    <MudItem md="6">
                        <ReadOnlyFieldX6 Label="@L[model.GetMemberDescription(x => x.SPackage)]" Value="model.SPackage"></ReadOnlyFieldX6>
                    </MudItem>
                    <MudItem md="6">
                        <ReadOnlyFieldX6 Label="@L[model.GetMemberDescription(x=>x.ExDate)]" Value="model.ExDate"></ReadOnlyFieldX6>
                    </MudItem>
                    <MudItem md="6">
                        <ReadOnlyFieldX6 Label="@L[model.GetMemberDescription(x => x.IsOwen)]" Value="model.IsOwen"></ReadOnlyFieldX6>
                    </MudItem>

                </MudGrid>
            </MudCardContent>
            <MudCardActions>
                <MudButton OnClick="OnGoBack">@ConstantString.GoBack</MudButton>
            </MudCardActions>
        </MudCard>
    }
</MudContainer>


@code {
    public string? Title { get; private set; }
    [Parameter]
    public int Id { get; set; }
    private SimCardDto? model;


    [Parameter]
    [SupplyParameterFromQuery]
    public string? ReturnUrl { get; set; }

    protected override async Task OnInitializedAsync()
    {
        Title = L["SimCard"];
        var result = await Mediator.Send(new GetSimCardByIdQuery() { Id = Id });
        result.Map(data =>
{
    model = data;
    return data;
}).Match(data =>
{
    return data;

}, errors =>
{
    Snackbar.Add(errors, MudBlazor.Severity.Error);
    return null!;
});
    }


    void OnGoBack()
    {
        ReturnBack();
    }

    void ReturnBack()
    {
        var target = !string.IsNullOrWhiteSpace(ReturnUrl)
            ? ReturnUrl
            : Navigation.ToBaseRelativePath(Navigation.Uri);
        Navigation.NavigateTo(target);
    }
}
