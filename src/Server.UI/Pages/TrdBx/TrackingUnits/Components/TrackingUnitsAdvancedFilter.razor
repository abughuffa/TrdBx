
@using CleanArchitecture.Blazor.Application.Features.TrackingUnits.Queries.Pagination
@using CleanArchitecture.Blazor.Domain.Enums
@using CleanArchitecture.Blazor.Server.UI.Pages.TrdBx.Customers.Components

@inject IStringLocalizer<TrackingUnits> L

<MudExpansionPanel @bind-Expanded="_advancedSearchExpanded"
                   Style="border-radius: var(--mud-default-borderradius) !important;"
                   Class="mud-elevation-25 pa-2 mb-3" Text="@ConstantString.AdvancedSearch">
    <MudGrid>

    @*      <MudItem md="6">
            <AvaliableCustomers  @bind-Value="TRequest.CustomerId"
                                Placeholder="@L["Search by Customer"]"
                           Clearable="true"
                           OnConditionChanged="TextChanged">
            </AvaliableCustomers>
        </MudItem>

        <MudItem md="6">
            <MudEnumSelect Style="min-width:120px"
                           Placeholder="@L["Status"]"
                           TEnum="UStatus"
                           Value="TRequest.UStatus"
                           ValueChanged="OnUStatusChanged"
                           Dense="true">
            </MudEnumSelect>
        </MudItem> *@
        <MudItem xs="12" sm="6" md="4">
            @*TODO: define advanced search query fields, for example:*@
            @*<MudTextField @bind-Value="TRequest.Name" 
                          Placeholder="@L["Search for name"]"
                          Clearable="true"
                          TextChanged="TextChanged">
            </MudTextField>*@
        </MudItem>
     </MudGrid>
</MudExpansionPanel>

@code {
    [EditorRequired][Parameter] public TrackingUnitsWithPaginationQuery TRequest { get; set; } = null!;
    [EditorRequired][Parameter] public EventCallback<string> OnConditionChanged { get; set; }
    private bool _advancedSearchExpanded;
    private async Task TextChanged(string str)
    {
        if (_advancedSearchExpanded)
        {
          await OnConditionChanged.InvokeAsync(str);
        }
    }


    // private async Task OnUStatusChanged(UStatus UStatus)
    // {
    //     TRequest.UStatus = UStatus;
    //     await TextChanged(UStatus.ToString());
    // }
}